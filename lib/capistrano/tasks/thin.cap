namespace :thin do
  commands = %w(start stop restart)

  commands.each do |command|
    task command do
      on roles(:app), in: :sequence, wait: 5 do
        within current_path do
          execute :bundle, "exec thin #{command} -C config/thin/#{fetch(:stage)}.yml"
        end
      end
    end
  end
end
